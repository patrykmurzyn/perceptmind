---
import Layout from '../layouts/Layout.astro';
import NeuralBackground from '../components/NeuralBackground.astro';
import Navbar from '../components/Navbar.astro';
import Contact from '../components/Contact.astro';
import Footer from '../components/Footer.astro';
---

<Layout
  title="PerceptMind | AI Solutions for Business"
  description="PerceptMind helps businesses deliver measurable outcomes with practical AI solutions."
  canonicalUrl="https://perceptmind.com/"
  ogImage="/favicon.svg"
>
  <Navbar />
  <NeuralBackground />

  <main id="hero">
    <h1 class="title">
      <span class="title-line title-top">Percept</span>
      <span class="title-line title-bottom">
        M<span class="i-container"><span class="i" id="mind-i">!</span></span>nd
      </span>
    </h1>
    <p class="subtitle">
      <span class="subtitle-content">
        <span>AI Solutions for</span>
        <span id="changing-text" class="highlight-text">Business</span>
      </span>
    </p>
  </main>

  <section class="offer-section" id="offer">
    <div class="offer-header">
      <span class="offer-kicker">What We Build</span>
      <h2>Offer</h2>
      <p>Select a track and see how we deliver it end-to-end.</p>
    </div>
    <div class="offer-carousel" data-offer-carousel>
      <button class="carousel-control" id="offer-prev" type="button" aria-label="Previous offer">
        ←
      </button>
      <div class="offer-viewport" tabindex="0" aria-label="Offer carousel">
        <div class="offer-track" id="offer-track">
      <article class="offer-slide panel-1" id="offer-ai-automation">
        <div class="panel-background-text">PURE EFFICIENCY</div>
        <div class="panel-content">
          <div class="panel-icon-wrapper large-icon">
            <svg width="240" height="240" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
              <!-- Glow -->
              <circle cx="100" cy="100" r="80" fill="#F59E0B" fill-opacity="0.05" filter="blur(30px)" />
              
              <!-- Outer Rotating Gear Segments -->
              <g id="auto-gear-outer">
                <g id="auto-gear-segments">
                  <path d="M100 20C105 20 110 21 115 23" stroke="#F59E0B" stroke-width="3" stroke-linecap="round"/>
                  <path d="M100 180C95 180 90 179 85 177" stroke="#F59E0B" stroke-width="3" stroke-linecap="round"/>
                  <path d="M20 100C20 95 21 90 23 85" stroke="#F59E0B" stroke-width="3" stroke-linecap="round"/>
                  <path d="M180 100C180 105 179 110 177 115" stroke="#F59E0B" stroke-width="3" stroke-linecap="round"/>
                </g>
                
                <circle id="auto-outer-ring" cx="100" cy="100" r="60" stroke="#F59E0B" stroke-width="1" stroke-dasharray="4 6" stroke-opacity="0.4"/>
              </g>

              <!-- Inner Spinning Mechanics -->
              <g id="auto-mechanics">
                <circle id="auto-inner-ring" cx="100" cy="100" r="50" stroke="#FBBF24" stroke-width="2" stroke-dasharray="10 10" stroke-opacity="0.6"/>
                <circle cx="100" cy="50" r="4" fill="#FBBF24"/>
                <circle cx="100" cy="150" r="4" fill="#FBBF24"/>
                <circle cx="50" cy="100" r="4" fill="#FBBF24"/>
                <circle cx="150" cy="100" r="4" fill="#FBBF24"/>
              </g>

              <!-- Central AI Chip (Processing) -->
              <g id="auto-chip">
                <rect x="75" y="75" width="50" height="50" rx="4" fill="var(--elevation-2)" stroke="#F59E0B" stroke-width="2"/>
                <!-- Circuit lines in chip -->
                <path d="M100 75V85" stroke="#F59E0B" stroke-width="2"/>
                <path d="M100 125V115" stroke="#F59E0B" stroke-width="2"/>
                <path d="M75 100H85" stroke="#F59E0B" stroke-width="2"/>
                <path d="M125 100H115" stroke="#F59E0B" stroke-width="2"/>
                <rect x="92" y="92" width="16" height="16" rx="2" fill="#F59E0B"/>
              </g>
              
              <!-- Processing Activity Particles -->
              <circle id="auto-particle-1" cx="80" cy="80" r="2" fill="#FFFFFF" opacity="0"/>
              <circle id="auto-particle-2" cx="120" cy="80" r="2" fill="#FFFFFF" opacity="0"/>
              <circle id="auto-particle-3" cx="120" cy="120" r="2" fill="#FFFFFF" opacity="0"/>
              <circle id="auto-particle-4" cx="80" cy="120" r="2" fill="#FFFFFF" opacity="0"/>
            </svg>
          </div>
          
          <div class="text-content">
            <h3 class="panel-title">AI Automation</h3>
            <p class="panel-description">
              <span class="highlight-phrase">Liberate your workflow.</span>
              Get rid of tedious work with AI, so you can focus on the essential things. Allow AI to support your daily work.
            </p>
          </div>
        </div>
      </article>
      <article class="offer-slide panel-2" id="offer-web-development">
        <div class="panel-background-text">MODERN WEB</div>
        <div class="panel-content">
          <div class="panel-icon-wrapper large-icon">
            <svg width="240" height="240" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
              <!-- Glow -->
              <circle cx="100" cy="100" r="80" fill="var(--color-primary-light)" fill-opacity="0.05" filter="blur(30px)" />
              
              <!-- Browser Window Frame -->
              <rect x="40" y="50" width="120" height="90" rx="4" stroke="var(--color-text-high)" stroke-width="2" fill="var(--elevation-2)" fill-opacity="0.8"/>
              <rect x="40" y="50" width="120" height="20" rx="4" fill="var(--elevation-3)"/>
              <circle cx="50" cy="60" r="3" fill="#EF4444"/>
              <circle cx="60" cy="60" r="3" fill="#F59E0B"/>
              <circle cx="70" cy="60" r="3" fill="#10B981"/>
              
              <!-- Scene: Code -->
              <g id="web-scene-code">
                <path id="web-line-1" d="M55 90H110" stroke="var(--color-text-medium)" stroke-width="2" stroke-linecap="round"/>
                <path id="web-line-2" d="M55 105H90" stroke="var(--color-text-medium)" stroke-width="2" stroke-linecap="round"/>
                <path id="web-line-3" d="M55 120H130" stroke="var(--color-text-medium)" stroke-width="2" stroke-linecap="round"/>
              </g>

              <!-- Scene: Window Layout -->
              <g id="web-scene-windows">
                <rect x="54" y="78" width="42" height="20" rx="3" fill="var(--elevation-1)" stroke="var(--color-primary-light)" stroke-opacity="0.6"/>
                <rect x="102" y="78" width="42" height="35" rx="3" fill="var(--elevation-1)" stroke="var(--color-primary-light)" stroke-opacity="0.6"/>
                <rect x="54" y="104" width="42" height="24" rx="3" fill="var(--elevation-1)" stroke="var(--color-primary-light)" stroke-opacity="0.6"/>
                <rect x="102" y="119" width="42" height="9" rx="3" fill="var(--color-primary-light)" fill-opacity="0.35"/>
              </g>

              <!-- Scene: Dashboard -->
              <g id="web-scene-dashboard">
                <rect x="55" y="78" width="18" height="52" rx="2" fill="var(--elevation-1)" stroke="var(--color-text-medium)" stroke-opacity="0.4"/>
                <rect x="79" y="78" width="65" height="14" rx="2" fill="var(--elevation-1)" stroke="var(--color-text-medium)" stroke-opacity="0.4"/>
                <rect x="79" y="98" width="20" height="32" rx="2" fill="var(--color-accent)" fill-opacity="0.3"/>
                <rect x="103" y="110" width="20" height="20" rx="2" fill="var(--color-primary-light)" fill-opacity="0.35"/>
                <rect x="127" y="102" width="17" height="28" rx="2" fill="#60A5FA" fill-opacity="0.3"/>
              </g>
              
              <!-- AI/LLM Connection (Floating Node) -->
              <circle cx="150" cy="150" r="25" fill="var(--elevation-1)" stroke="var(--color-accent)" stroke-width="2"/>
              <text x="150" y="155" font-family="Satoshi, sans-serif" font-size="14" font-weight="900" fill="var(--color-accent)" text-anchor="middle">LLM</text>
              
              <!-- API Gear/Node (Styled like LLM) -->
              <path d="M160 50C165 50 168 53 168 58" stroke="var(--color-primary-light)" stroke-width="2"/>
              <circle cx="160" cy="50" r="18" fill="var(--elevation-1)" stroke="var(--color-primary-light)" stroke-width="2"/>
              <text x="160" y="54" font-family="Satoshi, sans-serif" font-size="12" font-weight="900" fill="var(--color-primary-light)" text-anchor="middle">API</text>
            </svg>
          </div>
          
          <div class="text-content">
            <h3 class="panel-title">Web Development</h3>
            <p class="panel-description">
              <span class="highlight-phrase">Next-gen applications.</span>
              Classic web applications (API + Frontend) enhanced with LLMs and AI models.
              Robust, scalable systems that bridge traditional coding with modern intelligence.
            </p>
          </div>
        </div>
      </article>
      <article class="offer-slide panel-3" id="offer-ai-trust-security-solutions">
        <div class="panel-background-text">SECURE AI</div>
        <div class="panel-content">
          <div class="panel-icon-wrapper large-icon">
            <svg width="240" height="240" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
              <!-- Glow -->
              <circle cx="100" cy="100" r="80" fill="var(--color-status-success)" fill-opacity="0.05" filter="blur(30px)" />
              
              <!-- Outer Shield / Field (Pulsating) -->
              <path id="security-shield" d="M100 20C55 20 20 55 20 100C20 145 55 180 100 180C145 180 180 145 180 100C180 55 145 20 100 20Z" stroke="var(--color-status-success)" stroke-width="1" stroke-dasharray="2 4" opacity="0.5"/>
              
              <!-- Rotating Security Ring -->
              <g id="security-ring" transform-origin="100 100">
                <circle id="security-main-ring" cx="100" cy="100" r="60" stroke="var(--color-status-success)" stroke-width="2" stroke-dasharray="20 10"/>
                <circle cx="160" cy="100" r="4" fill="var(--color-status-success)"/>
                <circle cx="40" cy="100" r="4" fill="var(--color-status-success)"/>
                <circle cx="100" cy="160" r="4" fill="var(--color-status-success)"/>
                <circle cx="100" cy="40" r="4" fill="var(--color-status-success)"/>
              </g>

              <!-- Central Vault / Lock (Main focus) -->
              <g id="security-lock">
                <path d="M100 50L143.3 75V125L100 150L56.7 125V75L100 50Z" fill="var(--elevation-2)" stroke="var(--color-status-success)" stroke-width="3"/>
                <!-- Keyhole -->
                <circle cx="100" cy="95" r="8" fill="var(--color-status-success)"/>
                <path d="M100 95L92 120H108L100 95Z" fill="var(--color-status-success)"/>
              </g>
              
              <!-- Scanning Line (Animated) -->
              <path id="scan-line" d="M60 70H140" stroke="var(--color-accent)" stroke-width="2" stroke-opacity="0.8" />
            </svg>
          </div>
          
          <div class="text-content">
            <h3 class="panel-title">AI Trust & Security Solutions</h3>
            <p class="panel-description">
              <span class="highlight-phrase">Your data, your control.</span>
              We deploy local AI models with the highest security standards—ensuring your data never leaves your infrastructure. 
              With our <strong style="color: var(--color-text-high);">Human-in-the-Loop</strong> workflows, every critical AI result is verified by experts to minimize errors.
            </p>
          </div>
        </div>
      </article>
      <article class="offer-slide panel-4" id="offer-ai-strategy-consulting">
        <div class="panel-background-text">FUTURE VISION</div>
        <div class="panel-content">
          <div class="panel-icon-wrapper large-icon">
            <svg width="240" height="240" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
              <!-- Glow -->
              <circle cx="100" cy="100" r="80" fill="#8B5CF6" fill-opacity="0.05" filter="blur(30px)" />
              
              <!-- Strategic Paths (Connecting Lines) - Animated Drawing -->
              <path id="strat-path-1" d="M100 100L100 40" stroke="#8B5CF6" stroke-width="1.5" stroke-dasharray="2 2" opacity="0.6"/>
              <path id="strat-path-2" d="M100 100L152 130" stroke="#8B5CF6" stroke-width="1.5" stroke-dasharray="2 2" opacity="0.6"/>
              <path id="strat-path-3" d="M100 100L48 130" stroke="#8B5CF6" stroke-width="1.5" stroke-dasharray="2 2" opacity="0.6"/>
              
              <!-- Orbiting Nodes Group -->
              <g id="strat-orbits">
                <circle id="strat-main-ring" cx="100" cy="100" r="60" stroke="#8B5CF6" stroke-width="1" stroke-opacity="0.3" stroke-dasharray="6 6"/>
                <circle cx="100" cy="40" r="6" fill="#8B5CF6" stroke="var(--elevation-2)" stroke-width="2"/>
                <circle cx="152" cy="130" r="6" fill="#8B5CF6" stroke="var(--elevation-2)" stroke-width="2"/>
                <circle cx="48" cy="130" r="6" fill="#8B5CF6" stroke="var(--elevation-2)" stroke-width="2"/>
              </g>

              <!-- Central Vision / Core (Pulsing Star) -->
              <g id="strat-core">
                <!-- Outer diamond shape -->
                <path d="M100 75L125 100L100 125L75 100Z" fill="var(--elevation-2)" stroke="#C4B5FD" stroke-width="2"/>
                <!-- Inner star -->
                <path d="M100 85L105 95L115 100L105 105L100 115L95 105L85 100L95 95Z" fill="#8B5CF6"/>
              </g>
              
              <!-- Future Beams (Scanning outward) -->
              <path id="beam-1" d="M100 40L100 10" stroke="#C4B5FD" stroke-width="2" opacity="0" stroke-linecap="round"/>
              <path id="beam-2" d="M152 130L178 145" stroke="#C4B5FD" stroke-width="2" opacity="0" stroke-linecap="round"/>
              <path id="beam-3" d="M48 130L22 145" stroke="#C4B5FD" stroke-width="2" opacity="0" stroke-linecap="round"/>
            </svg>
          </div>
          
          <div class="text-content">
            <h3 class="panel-title">AI Strategy & Consulting</h3>
            <p class="panel-description">
              <span class="highlight-phrase">Navigate the future.</span>
              Don't implement AI blindly. We help you identify high-ROI opportunities and build a comprehensive <strong style="color: var(--color-text-high);">digital transformation roadmap</strong> tailored to your business goals.
            </p>
          </div>
        </div>
      </article>
        </div>
      </div>
      <button class="carousel-control" id="offer-next" type="button" aria-label="Next offer">
        →
      </button>
    </div>
    <div class="offer-dots" aria-label="Offer slides">
      <button type="button" class="offer-dot is-active" data-offer-index="0" aria-label="Go to AI Automation"></button>
      <button type="button" class="offer-dot" data-offer-index="1" aria-label="Go to Web Development"></button>
      <button type="button" class="offer-dot" data-offer-index="2" aria-label="Go to AI Trust and Security Solutions"></button>
      <button type="button" class="offer-dot" data-offer-index="3" aria-label="Go to AI Strategy and Consulting"></button>
    </div>
  </section>

  <Contact />
  <Footer />

  <script>
    import { gsap } from 'gsap';

    const iElement = document.getElementById('mind-i') as HTMLSpanElement | null;
    const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    const offerTrack = document.getElementById('offer-track') as HTMLDivElement | null;
    const offerCarousel = document.querySelector('[data-offer-carousel]') as HTMLDivElement | null;
    const offerViewport = offerCarousel?.querySelector('.offer-viewport') as HTMLDivElement | null;
    const initialOfferSlides = Array.from(offerTrack?.querySelectorAll('.offer-slide') ?? []) as HTMLElement[];
    const prevOfferButton = document.getElementById('offer-prev') as HTMLButtonElement | null;
    const nextOfferButton = document.getElementById('offer-next') as HTMLButtonElement | null;
    const offerDots = Array.from(document.querySelectorAll('.offer-dot')) as HTMLButtonElement[];
    const offerSection = document.getElementById('offer') as HTMLElement | null;
    let pendingCall: gsap.core.Tween | null = null;
    let textRotationCall: gsap.core.Tween | null = null;
    let activeOfferIndex = 0;
    let touchStartX = 0;
    let touchStartY = 0;
    let isTouchTracking = false;
    let isOfferWrapping = false;

    const offerSlides = [...initialOfferSlides];
    const realOfferCount = offerSlides.length;
    const hasOfferLoop = realOfferCount > 1;

    function getOfferTrackTransition() {
      return prefersReducedMotion ? 'none' : 'transform 0.45s ease';
    }

    function normalizeOfferIndex(index: number) {
      if (realOfferCount === 0) return 0;
      return ((index % realOfferCount) + realOfferCount) % realOfferCount;
    }

    function setOfferTrackPosition(trackIndex: number, animate = true) {
      if (!offerTrack) return;
      offerTrack.style.transition = animate ? getOfferTrackTransition() : 'none';
      offerTrack.style.transform = `translateX(-${trackIndex * 100}%)`;
      if (!animate) {
        requestAnimationFrame(() => {
          if (offerTrack) offerTrack.style.transition = getOfferTrackTransition();
        });
      }
    }

    if (offerTrack && hasOfferLoop) {
      const firstClone = offerSlides[0].cloneNode(true) as HTMLElement;
      const lastClone = offerSlides[realOfferCount - 1].cloneNode(true) as HTMLElement;

      firstClone.id = `${offerSlides[0].id}-clone`;
      lastClone.id = `${offerSlides[realOfferCount - 1].id}-clone`;
      firstClone.setAttribute('aria-hidden', 'true');
      lastClone.setAttribute('aria-hidden', 'true');

      offerTrack.appendChild(firstClone);
      offerTrack.insertBefore(lastClone, offerTrack.firstChild);
    }

    if (!iElement) {
      console.warn('Animated title element not found.');
    } else if (prefersReducedMotion) {
      gsap.set(iElement, {
        display: 'inline-block',
        transformOrigin: 'center center',
        rotationX: 0,
        color: 'var(--color-accent)'
      });
    } else {
      const mindChar = iElement;

      gsap.set(mindChar, {
        display: 'inline-block',
        transformOrigin: 'center center',
        rotationX: 0,
        color: 'var(--color-accent)'
      });

      gsap.to('body', { autoAlpha: 1, duration: 0.5 });

      gsap.from('.title', {
        y: 50,
        opacity: 0,
        duration: 1,
        stagger: 0.2
      });

      gsap.from('.subtitle', {
        y: 20,
        opacity: 0,
        duration: 1,
        delay: 0.5
      });
      function scheduleNextFlip() {
        const randomDelay = Math.random() * 20 + 20;
        pendingCall = gsap.delayedCall(randomDelay, flipToIAndBack);
      }

      function flipToIAndBack() {
        const flipDuration = 0.5;
        const holdDuration = 2;

        gsap.timeline({
          onComplete: () => {
            scheduleNextFlip();
          }
        })
          .to(mindChar, {
            rotationX: 90,
            duration: flipDuration / 2,
            ease: 'power2.inOut'
          })
          .add(() => {
            mindChar.textContent = 'i';
            gsap.set(mindChar, { rotationX: -90, color: 'var(--color-text-high)' });
          })
          .to(mindChar, {
            rotationX: 0,
            duration: flipDuration / 2,
            ease: 'power2.inOut'
          })
          .to(mindChar, {
            duration: holdDuration
          })
          .to(mindChar, {
            rotationX: 90,
            duration: flipDuration / 2,
            ease: 'power2.inOut'
          })
          .add(() => {
            mindChar.textContent = '!';
            gsap.set(mindChar, { rotationX: -90, color: 'var(--color-accent)' });
          })
          .to(mindChar, {
            rotationX: 0,
            duration: flipDuration / 2,
            ease: 'power2.inOut'
          });
      }

      pendingCall = gsap.delayedCall(Math.random() * 5 + 2, scheduleNextFlip);

      // Text rotation logic
      const changingText = document.getElementById('changing-text');
      const words = ["Growth", "Results", "Leaders", "Efficiency", "Success", "Challenges", "Scale", "Productivity", "Precision", "Speed", "Impact", "Tomorrow", "Builders", "Business", "Needs"];
      let currentWordIndex = 0;

      if (changingText) {
        // Set initial style
        gsap.set(changingText, { display: 'inline-block' });

        function rotateText() {
          const nextWord = words[currentWordIndex];
          currentWordIndex = (currentWordIndex + 1) % words.length;

          gsap.to(changingText, {
            y: -20,
            opacity: 0,
            duration: 0.5,
            ease: 'power2.in',
            onComplete: () => {
              if (changingText) {
                changingText.textContent = nextWord;
                gsap.fromTo(changingText,
                  { y: 20, opacity: 0 },
                  { y: 0, opacity: 1, duration: 0.5, ease: 'power2.out' }
                );
              }
            }
          });
          
          textRotationCall = gsap.delayedCall(3.5, rotateText);
        }

        // Start the rotation loop after initial delay
        textRotationCall = gsap.delayedCall(3.5, rotateText);
      }

      // Web Dev Animation: Simulate lines changing length (scrolling/loading effect)
      const webSceneCode = document.getElementById('web-scene-code');
      const webSceneWindows = document.getElementById('web-scene-windows');
      const webSceneDashboard = document.getElementById('web-scene-dashboard');
      const webScenes = [webSceneCode, webSceneWindows, webSceneDashboard].filter(Boolean);

      if (webScenes.length === 3) {
        gsap.set(webScenes, { autoAlpha: 0 });
        gsap.set(webSceneCode, { autoAlpha: 1 });

        const webScenesLoop = gsap.timeline({ repeat: -1, repeatDelay: 0.3 });
        webScenesLoop
          .to({}, { duration: 2.8 })
          .to(webSceneCode, { autoAlpha: 0, duration: 0.22, ease: "sine.inOut" })
          .to(webSceneWindows, { autoAlpha: 1, duration: 0.22, ease: "sine.inOut" }, "<")
          .to({}, { duration: 2.8 })
          .to(webSceneWindows, { autoAlpha: 0, duration: 0.22, ease: "sine.inOut" })
          .to(webSceneDashboard, { autoAlpha: 1, duration: 0.22, ease: "sine.inOut" }, "<")
          .to({}, { duration: 2.8 })
          .to(webSceneDashboard, { autoAlpha: 0, duration: 0.22, ease: "sine.inOut" })
          .to(webSceneCode, { autoAlpha: 1, duration: 0.22, ease: "sine.inOut" }, "<");
      }

      const webLines = ['#web-line-1', '#web-line-2', '#web-line-3'];
      webLines.forEach((id, index) => {
        const line = document.querySelector(id);
        if (line) {
          gsap.set(line, { transformOrigin: "left center" });
          
          function animateLine() {
            gsap.to(line, {
              scaleX: Math.random() * 0.5 + 0.5, // Random scale between 0.5 and 1.0
              duration: 0.5 + Math.random() * 0.5, // Random duration
              ease: "power1.inOut",
              delay: Math.random() * 2, // Random delay
              onComplete: animateLine
            });
          }
          // Start slightly staggered
          gsap.delayedCall(index * 0.5, animateLine);
        }
      });

      // Security Animation: Rotating ring, pulsing shield, scanning line
      const securityRing = document.getElementById('security-ring');
      const securityMainRing = document.getElementById('security-main-ring');
      const securityShield = document.getElementById('security-shield');
      const scanLine = document.getElementById('scan-line');

      if (securityMainRing) {
        gsap.to(securityMainRing, {
          strokeDashoffset: -240,
          duration: 14,
          ease: "none",
          repeat: -1
        });
      }

      if (securityRing) {
        gsap.set(securityRing, { transformOrigin: "100px 100px" });
      }

      if (securityShield) {
        gsap.to(securityShield, {
          opacity: 0.8,
          scale: 1.05,
          duration: 2,
          yoyo: true,
          repeat: -1,
          ease: "sine.inOut",
          transformOrigin: "center center"
        });
      }
      
      if (scanLine) {
        gsap.fromTo(scanLine, 
          { y: 0, opacity: 0 },
          { 
            y: 60, 
            opacity: 1, 
            duration: 2, 
            repeat: -1, 
            yoyo: true,
            ease: "power1.inOut" 
          }
        );
      }

      // Strategy Animation: Pulsing core, rotating orbits, flashing beams
      const stratCore = document.getElementById('strat-core');
      const stratOrbits = document.getElementById('strat-orbits');
      const stratMainRing = document.getElementById('strat-main-ring');
      
      if (stratCore) {
        gsap.to(stratCore, {
          scale: 1.1,
          duration: 1.5,
          yoyo: true,
          repeat: -1,
          ease: "sine.inOut",
          transformOrigin: "center center"
        });
      }

      if (stratMainRing) {
        gsap.to(stratMainRing, {
          strokeDashoffset: -180,
          duration: 18,
          ease: "none",
          repeat: -1
        });
      }

      if (stratOrbits) {
        gsap.set(stratOrbits, { transformOrigin: "100px 100px" });
      }

      const beams = ['#beam-1', '#beam-2', '#beam-3'];
      beams.forEach((id, i) => {
        const beam = document.querySelector(id);
        if (beam) {
          gsap.fromTo(beam,
            { opacity: 0, scale: 0.8 },
            { 
              opacity: 1, 
              scale: 1.2,
              duration: 1,
              repeat: -1,
              yoyo: true,
              ease: "power2.out",
              delay: i * 0.6 // Staggered pulses
            }
          );
        }
      });

      // Automation Animation: Animated outer ring stroke, rotating mechanics, pulsing chip, flashing particles
      const autoGearOuter = document.getElementById('auto-gear-outer');
      const autoGearSegments = document.getElementById('auto-gear-segments');
      const autoOuterRing = document.getElementById('auto-outer-ring');
      const autoInnerRing = document.getElementById('auto-inner-ring');
      const autoMechanics = document.getElementById('auto-mechanics');
      const autoChip = document.getElementById('auto-chip');
      
      if (autoOuterRing) {
        gsap.to(autoOuterRing, {
          strokeDashoffset: -200,
          duration: 12,
          ease: "none",
          repeat: -1
        });
      }

      if (autoGearOuter) {
        gsap.set(autoGearOuter, { transformOrigin: "50% 50%" }); // Use element center
      }

      if (autoGearSegments) {
        gsap.set(autoGearSegments, { svgOrigin: "100 100" });
        gsap.to(autoGearSegments, {
          rotation: 360,
          duration: 22,
          ease: "none",
          repeat: -1
        });
      }

      if (autoInnerRing) {
        gsap.to(autoInnerRing, {
          strokeDashoffset: 200,
          duration: 10,
          ease: "none",
          repeat: -1
        });
      }

      if (autoMechanics) {
        gsap.set(autoMechanics, { transformOrigin: "50% 50%" }); // Use element center
      }

      if (autoChip) {
        gsap.set(autoChip, { transformOrigin: "center center" });
        gsap.to(autoChip, {
          scale: 1.05,
          duration: 0.8,
          yoyo: true,
          repeat: -1,
          ease: "sine.inOut"
        });
      }

      const particles = ['#auto-particle-1', '#auto-particle-2', '#auto-particle-3', '#auto-particle-4'];
      particles.forEach((id) => {
        const p = document.querySelector(id);
        if (p) {
          gsap.to(p, {
            opacity: 1,
            duration: 0.1,
            repeat: -1,
            yoyo: true,
            repeatDelay: Math.random() * 0.5,
            delay: Math.random() * 1
          });
        }
      });
    }

    function syncOfferDots(index: number) {
      offerDots.forEach((dot, dotIndex) => {
        const isActive = dotIndex === index;
        dot.classList.toggle('is-active', isActive);
        dot.setAttribute('aria-current', isActive ? 'true' : 'false');
      });
      if (prevOfferButton) prevOfferButton.disabled = !hasOfferLoop && index === 0;
      if (nextOfferButton) nextOfferButton.disabled = !hasOfferLoop && index === realOfferCount - 1;
    }

    function goToOffer(index: number, includeScroll = false, animate = true) {
      if (!offerTrack || realOfferCount === 0 || isOfferWrapping) return;
      activeOfferIndex = hasOfferLoop
        ? normalizeOfferIndex(index)
        : Math.max(0, Math.min(index, realOfferCount - 1));
      const targetIndex = hasOfferLoop ? activeOfferIndex + 1 : activeOfferIndex;
      setOfferTrackPosition(targetIndex, animate);
      syncOfferDots(activeOfferIndex);
      if (includeScroll && offerSection) {
        offerSection.scrollIntoView({ behavior: prefersReducedMotion ? 'auto' : 'smooth', block: 'start' });
      }
    }

    function goToNextOffer(includeScroll = false) {
      if (!offerTrack || realOfferCount === 0 || isOfferWrapping) return;
      if (!hasOfferLoop) {
        goToOffer(activeOfferIndex + 1, includeScroll);
        return;
      }
      if (activeOfferIndex === realOfferCount - 1) {
        if (prefersReducedMotion) {
          goToOffer(0, includeScroll, false);
          return;
        }
        isOfferWrapping = true;
        activeOfferIndex = 0;
        syncOfferDots(activeOfferIndex);
        setOfferTrackPosition(realOfferCount + 1, true);
        if (includeScroll && offerSection) {
          offerSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
        return;
      }
      goToOffer(activeOfferIndex + 1, includeScroll);
    }

    function goToPreviousOffer(includeScroll = false) {
      if (!offerTrack || realOfferCount === 0 || isOfferWrapping) return;
      if (!hasOfferLoop) {
        goToOffer(activeOfferIndex - 1, includeScroll);
        return;
      }
      if (activeOfferIndex === 0) {
        if (prefersReducedMotion) {
          goToOffer(realOfferCount - 1, includeScroll, false);
          return;
        }
        isOfferWrapping = true;
        activeOfferIndex = realOfferCount - 1;
        syncOfferDots(activeOfferIndex);
        setOfferTrackPosition(0, true);
        if (includeScroll && offerSection) {
          offerSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
        return;
      }
      goToOffer(activeOfferIndex - 1, includeScroll);
    }

    function goToOfferByHash() {
      const hash = window.location.hash.replace('#', '');
      if (!hash) return;
      const index = offerSlides.findIndex((slide) => slide.id === hash);
      if (index >= 0) {
        goToOffer(index);
      }
    }

    if (offerTrack && realOfferCount > 0) {
      offerCarousel?.classList.add('is-ready');
      offerSection?.classList.add('is-ready');
      setOfferTrackPosition(hasOfferLoop ? 1 : 0, false);
      syncOfferDots(activeOfferIndex);
      offerTrack.addEventListener('transitionend', (event) => {
        if (!(event.target instanceof HTMLElement) || event.target !== offerTrack) return;
        if (event.propertyName !== 'transform' || !isOfferWrapping) return;
        isOfferWrapping = false;
        setOfferTrackPosition(activeOfferIndex + 1, false);
      });
      prevOfferButton?.addEventListener('click', () => {
        goToPreviousOffer();
      });
      nextOfferButton?.addEventListener('click', () => {
        goToNextOffer();
      });
      offerDots.forEach((dot) => {
        dot.addEventListener('click', () => {
          const index = Number(dot.dataset.offerIndex);
          if (Number.isFinite(index)) {
            goToOffer(index);
          }
        });
      });

      offerViewport?.addEventListener('keydown', (event) => {
        if (event.key === 'ArrowRight') {
          event.preventDefault();
          goToNextOffer();
        } else if (event.key === 'ArrowLeft') {
          event.preventDefault();
          goToPreviousOffer();
        } else if (event.key === 'Home') {
          event.preventDefault();
          goToOffer(0);
        } else if (event.key === 'End') {
          event.preventDefault();
          goToOffer(realOfferCount - 1);
        }
      });

      offerViewport?.addEventListener(
        'touchstart',
        (event) => {
          if (event.touches.length !== 1) return;
          touchStartX = event.touches[0].clientX;
          touchStartY = event.touches[0].clientY;
          isTouchTracking = true;
        },
        { passive: true }
      );

      offerViewport?.addEventListener(
        'touchend',
        (event) => {
          if (!isTouchTracking || event.changedTouches.length !== 1) return;
          const touch = event.changedTouches[0];
          const deltaX = touch.clientX - touchStartX;
          const deltaY = touch.clientY - touchStartY;
          isTouchTracking = false;

          if (Math.abs(deltaX) < 48 || Math.abs(deltaX) <= Math.abs(deltaY)) {
            return;
          }

          if (deltaX < 0) {
            goToNextOffer();
          } else {
            goToPreviousOffer();
          }
        },
        { passive: true }
      );

      window.addEventListener('offer:go', (event) => {
        const customEvent = event as CustomEvent<{ index?: number }>;
        const index = customEvent.detail?.index;
        if (typeof index === 'number') {
          goToOffer(index, true);
        }
      });
      window.addEventListener('hashchange', goToOfferByHash);
      goToOfferByHash();
    }

    window.addEventListener('beforeunload', () => {
      pendingCall?.kill();
      textRotationCall?.kill();
    });
  </script>

  <style>
    main {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: auto;
      min-height: 100vh;
      min-height: 100svh;
      width: 100%;
      padding-top: clamp(4.5rem, 7vh, 6rem);
      padding-bottom: var(--space-m);
      gap: var(--space-3xs);
    }

    .title {
      display: flex;
      flex-direction: column;
      align-items: center;
      font-family: 'Satoshi', sans-serif;
      font-weight: 900;
      font-size: var(--font-size-6xl);
      line-height: 1.1;
      margin: 0;
      letter-spacing: -0.02em;
      color: var(--color-text-high);
      text-transform: none;
      position: relative;
    }

    .title-line {
      display: block;
    }

    .title-bottom {
      margin-top: -0.05em;
      margin-left: -0.245em;
    }

    .subtitle {
      font-family: 'Satoshi', sans-serif;
      font-weight: 500;
      font-size: var(--font-size-xl);
      color: var(--color-text-medium);
      margin-top: var(--space-s);
      letter-spacing: 0.05em;
      text-transform: uppercase;
      text-align: center;
      padding-inline: var(--space-m);
      display: inline-flex;
      flex-direction: column;
      align-items: center;
      gap: 0.16em;
    }

    .subtitle-content {
      display: flex;
      align-items: baseline;
      gap: 0.3em; /* space between "for" and "Business" */
    }



    .highlight-text {
      display: inline-block;
      width: 7.5em; /* Fixed width to accommodate longest word "Productivity" */
      text-align: left;
    }



    .i-container {
      display: inline-flex;
      justify-content: center;
      align-items: center;
      width: 0.34em;
      position: relative;
    }

    .i {
      display: inline-block;
      transform-style: preserve-3d;
      transform-origin: center center;
      color: var(--color-accent);
      width: 100%;
      text-align: center;
    }

    .offer-section {
      width: 100%;
      margin: 0;
      padding: var(--space-xl) 0 var(--space-2xl);
      background:
        radial-gradient(circle at 50% 0%, rgba(30, 144, 255, 0.1), rgba(8, 12, 20, 0) 56%),
        linear-gradient(180deg, rgba(8, 12, 20, 0), rgba(8, 12, 20, 0.58) 18%, rgba(8, 12, 20, 0) 100%);
    }

    .offer-header {
      width: min(1120px, 100%);
      margin-inline: auto;
      text-align: center;
      margin-bottom: var(--space-l);
      padding-inline: var(--space-m);
    }

    .offer-kicker {
      display: inline-block;
      font-size: var(--font-size-sm);
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: var(--color-accent);
      margin-bottom: 0.45rem;
      font-weight: 700;
    }

    .offer-header h2 {
      margin: 0;
      font-size: var(--font-size-5xl);
      letter-spacing: -0.02em;
      line-height: 0.95;
      text-transform: uppercase;
    }

    .offer-header p {
      margin: var(--space-xs) auto 0;
      color: var(--color-text-medium);
      max-width: 48ch;
      font-size: var(--font-size-base);
    }

    .offer-carousel {
      width: min(1380px, 100%);
      margin-inline: auto;
      padding-inline: var(--space-m);
      display: flex;
      flex-direction: column;
      gap: var(--space-m);
      position: relative;
    }

    .offer-viewport {
      overflow: visible;
      width: 100%;
      border-radius: 1rem;
      box-shadow:
        0 18px 40px rgba(0, 0, 0, 0.35),
        0 2px 0 rgba(255, 255, 255, 0.07) inset;
    }

    .offer-track {
      display: grid;
      gap: var(--space-m);
    }

    .offer-slide {
      width: 100%;
      flex: 0 0 100%;
      min-height: min(86vh, 900px);
      display: flex;
      align-items: center;
      justify-content: center;
      contain: layout paint;
      border-radius: 1rem;
      overflow: hidden;
    }

    .carousel-control {
      display: inline-grid;
      place-items: center;
      width: 2.6rem;
      height: 2.6rem;
      border-radius: 9999px;
      border: 1px solid rgba(255, 255, 255, 0.16);
      color: var(--color-text-high);
      background: rgba(255, 255, 255, 0.04);
      cursor: pointer;
      font-size: 1.2rem;
      transition: border-color 0.2s ease, background-color 0.2s ease, color 0.2s ease;
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
    }

    .carousel-control:hover {
      border-color: rgba(249, 115, 22, 0.7);
      color: var(--color-accent);
      background: rgba(249, 115, 22, 0.08);
    }

    .carousel-control:disabled {
      opacity: 0.38;
      cursor: not-allowed;
    }

    .carousel-control:focus-visible {
      outline: 2px solid var(--color-accent);
      outline-offset: 2px;
    }

    .offer-dots {
      display: flex;
      justify-content: center;
      gap: 0.45rem;
      margin-top: var(--space-s);
      min-height: 0.62rem;
      visibility: hidden;
      pointer-events: none;
    }

    .offer-section.is-ready .offer-dots {
      visibility: visible;
      pointer-events: auto;
    }

    .offer-carousel.is-ready {
      display: block;
    }

    .offer-carousel.is-ready .offer-viewport {
      overflow: hidden;
    }

    .offer-carousel.is-ready .offer-track {
      display: flex;
      gap: 0;
      transform: translateX(0);
      transition: transform 0.45s ease;
      will-change: transform;
    }

    .offer-carousel.is-ready .carousel-control {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      z-index: 3;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      opacity: 1;
      visibility: visible;
      pointer-events: auto;
    }

    #offer-prev {
      left: calc(var(--space-m) + 0.6rem);
    }

    #offer-next {
      right: calc(var(--space-m) + 0.6rem);
    }

    .offer-dot {
      width: 0.62rem;
      height: 0.62rem;
      border-radius: 9999px;
      border: 0;
      background: rgba(255, 255, 255, 0.28);
      cursor: pointer;
      transition: transform 0.2s ease, background-color 0.2s ease;
    }

    .offer-dot.is-active {
      background: var(--color-accent);
      transform: scale(1.15);
    }

    .offer-dot:focus-visible {
      outline: 2px solid var(--color-accent);
      outline-offset: 2px;
    }

    .panel-1,
    .panel-2,
    .panel-3,
    .panel-4 {
      width: 100%;
      position: relative;
      overflow: hidden;
    }

    .panel-1 {
      background: radial-gradient(circle at 60% 40%, #92400e 0%, #451a03 100%); /* Darker Amber -> Dark Bronze */
      position: relative;
      overflow: hidden;
    }

    .panel-2 {
      background: radial-gradient(circle at 40% 60%, #1e40af 0%, #172554 100%); /* Deep Royal Blue -> Dark Navy */
      position: relative;
      overflow: hidden;
    }
    
    .panel-2 .panel-background-text {
      color: var(--color-primary-light);
    }
    
    .panel-2 .highlight-phrase {
      color: var(--color-primary-light);
    }

    .panel-3 {
      background: radial-gradient(circle at 50% 50%, var(--elevation-2) 0%, #064e3b 100%); /* Greenish tint at edges */
      position: relative;
      overflow: hidden;
    }
    
    .panel-3 .panel-background-text {
      color: var(--color-status-success);
    }
    
    .panel-3 .highlight-phrase {
      color: var(--color-status-success);
    }

    .panel-4 {
      background: radial-gradient(circle at 50% 50%, var(--elevation-3) 0%, #2e1065 100%); /* Deep Purple base */
      position: relative;
      overflow: hidden;
    }
    
    .panel-4 .panel-background-text {
      color: #8B5CF6; /* Violet */
    }
    
    .panel-4 .highlight-phrase {
      color: #8B5CF6;
    }

    @media (prefers-reduced-motion: reduce) {
      .i {
        transform: none;
      }
      .offer-carousel.is-ready .offer-track {
        transition: none;
      }
    }

    @media (max-width: 640px) {
      .subtitle {
        margin-top: var(--space-xs);
        font-size: var(--font-size-lg);
        letter-spacing: 0.03em;
      }

      .subtitle-content {
        flex-direction: column;
        align-items: center;
        gap: 0.1em;
      }

      .subtitle-content span:first-child {
        white-space: nowrap;
      }

      .highlight-text {
        width: 100%;
        min-height: 1.25em;
        text-align: center;
      }

      .offer-carousel {
        gap: 0.45rem;
        padding-inline: var(--space-s);
      }

      .carousel-control {
        width: 2.3rem;
        height: 2.3rem;
      }

      .offer-slide {
        min-height: min(82vh, 760px);
      }

      .offer-section {
        padding-inline: 0;
      }

      .offer-header {
        margin-bottom: var(--space-m);
      }

      .offer-header h2 {
        font-size: var(--font-size-4xl);
      }

      #offer-prev {
        left: calc(var(--space-s) + 0.2rem);
      }

      #offer-next {
        right: calc(var(--space-s) + 0.2rem);
      }
    }

    .panel-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      max-width: 900px;
      padding: var(--space-xl);
      position: relative;
      z-index: 2; /* Sit above the background text */
    }

    .panel-background-text {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 100%;
      transform: translate(-50%, -50%) rotate(-8deg);
      font-family: 'Satoshi', sans-serif;
      font-weight: 900;
      font-size: clamp(2.4rem, 9.5vw, 9rem);
      color: var(--color-accent);
      opacity: 0.05;
      white-space: nowrap;
      text-align: center;
      pointer-events: none;
      z-index: 1;
      text-transform: uppercase;
      letter-spacing: -0.05em;
    }

    @media (max-width: 900px) {
      .panel-background-text {
        font-size: clamp(2rem, 11vw, 6rem);
        transform: translate(-50%, -50%) rotate(-5deg);
      }
    }

    .panel-title {
      font-family: 'Satoshi', sans-serif;
      font-size: var(--font-size-5xl);
      font-weight: 900;
      color: var(--color-text-high);
      margin-bottom: var(--space-s);
      text-transform: uppercase;
      letter-spacing: -0.02em;
      margin-top: 0;
      text-shadow: 0 4px 30px rgba(0,0,0,0.5);
    }

    .panel-description {
      font-family: 'Satoshi', sans-serif;
      font-size: var(--font-size-xl);
      color: var(--color-text-medium);
      line-height: 1.5;
      max-width: 50ch;
      margin: 0;
      font-weight: 400;
    }
    
    .panel-description .highlight-phrase {
      display: block;
      color: var(--color-text-high);
      font-weight: 700;
      font-size: 1.1em;
      margin-bottom: var(--space-xs);
      color: var(--color-accent);
    }

    .panel-icon-wrapper {
      margin-bottom: var(--space-l);
      display: flex;
      align-items: center;
      justify-content: center;
      filter: drop-shadow(0 0 20px rgba(249, 115, 22, 0.2));
    }
  </style>
</Layout>
